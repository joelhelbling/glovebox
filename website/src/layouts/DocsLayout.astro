---
import BaseLayout from './BaseLayout.astro';

interface Props {
  title: string;
  description?: string;
  section?: string;
  order?: number;
}

const { title, description, section, order } = Astro.props;

const docsSections = [
  { num: '01', title: 'Getting Started', slug: 'getting-started', description: 'Installation and first run' },
  { num: '02', title: 'Commands', slug: 'commands', description: 'The complete command reference' },
  { num: '03', title: 'Mods', slug: 'mods', description: 'Available mods and how they compose' },
  { num: '04', title: 'Custom Mods', slug: 'custom-mods', description: 'Creating your own mods' },
  { num: '05', title: 'Architecture', slug: 'architecture', description: 'How layered images and persistence work' },
  { num: '06', title: 'Workflows', slug: 'workflows', description: 'Common usage patterns' },
  { num: '07', title: 'Configuration', slug: 'configuration', description: 'Profiles and environment variables' },
];

const currentPath = Astro.url.pathname;
---

<BaseLayout title={title} description={description}>
  <div class="container-wide py-12">
    <div class="flex flex-col lg:flex-row gap-12">
      <!-- Sidebar -->
      <aside class="lg:w-64 flex-shrink-0">
        <nav class="sticky top-24">
          <h2 class="text-xs font-medium uppercase tracking-wider text-muted mb-4">
            Operating Manual
          </h2>
          <ul class="space-y-1">
            {docsSections.map(doc => (
              <li>
                <a
                  href={`/docs/${doc.slug}/`}
                  class:list={[
                    'docs-link flex items-baseline gap-2',
                    { 'active': currentPath.includes(doc.slug) }
                  ]}
                >
                  <span class="section-number">{doc.num}.</span>
                  <span>{doc.title}</span>
                </a>
              </li>
            ))}
          </ul>
        </nav>
      </aside>

      <!-- Main content -->
      <article class="flex-1 min-w-0">
        {section && (
          <header class="mb-8 p-6 bg-white rounded-lg shadow-card border-hairline border-muted/20">
            <div class="section-number mb-2">{order ? String(order).padStart(2, '0') : '00'}.</div>
            <h1 class="text-4xl font-medium">{title}</h1>
            {description && <p class="mt-3 text-lg text-muted">{description}</p>}
          </header>
        )}

        <div class="prose prose-lg max-w-none">
          <slot />
        </div>

        <!-- Prev/Next navigation -->
        <nav class="mt-12 py-6 px-6 bg-white rounded-lg shadow-card border-hairline border-muted/20 flex items-center justify-between">
          {order && order > 1 && (
            <a
              href={`/docs/${docsSections[order - 2].slug}/`}
              class="group flex items-center gap-2 text-muted hover:text-ink"
            >
              <svg class="w-5 h-5 group-hover:-translate-x-1 transition-transform" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M19 12H5M12 19l-7-7 7-7"/>
              </svg>
              <span>
                <span class="block text-xs uppercase tracking-wider">Previous</span>
                <span class="font-medium">{docsSections[order - 2].title}</span>
              </span>
            </a>
          )}
          {(!order || order === 1) && <div></div>}
          {order && order < docsSections.length && (
            <a
              href={`/docs/${docsSections[order].slug}/`}
              class="group flex items-center gap-2 text-muted hover:text-ink text-right"
            >
              <span>
                <span class="block text-xs uppercase tracking-wider">Next</span>
                <span class="font-medium">{docsSections[order].title}</span>
              </span>
              <svg class="w-5 h-5 group-hover:translate-x-1 transition-transform" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M5 12h14M12 5l7 7-7 7"/>
              </svg>
            </a>
          )}
        </nav>
      </article>
    </div>
  </div>
</BaseLayout>
