name: ubuntu
description: Ubuntu base image with core dependencies
category: os
dockerfile_from: ubuntu:24.04
provides:
  - base

run_as_root: |
  # Avoid interactive prompts during package installation
  export DEBIAN_FRONTEND=noninteractive

  # Install core packages
  apt-get update && apt-get install -y \
    curl \
    wget \
    git \
    build-essential \
    software-properties-common \
    unzip \
    ca-certificates \
    gnupg \
    sudo \
    jq \
    libffi-dev \
    libyaml-dev \
    && rm -rf /var/lib/apt/lists/*

  # Remove the default ubuntu user and create dev user
  userdel -r ubuntu 2>/dev/null || true
  useradd -m -s /bin/bash -u 1000 dev
  echo "dev ALL=(root) NOPASSWD:ALL" > /etc/sudoers.d/dev
  chmod 0440 /etc/sudoers.d/dev
  mkdir -p /home/dev/.local/bin
  chown -R dev:dev /home/dev
